import{P as e,j as s,R as O,r as m,S as k}from"./index-DnSvBsN8.js";import{P as w}from"./PageHeader-Y3u8qxoU.js";import{a as L,l as E}from"./sleeperApi-BE8q_8nq.js";import{u as S}from"./useFetchPlayers-DPyeBxHR.js";import{u as C}from"./useFetchTeams-DnNVNvoc.js";const y=({setViewType:a})=>s.jsxs(s.Fragment,{children:[s.jsx(w,{pageTitle:"League Transactions"}),s.jsxs("div",{className:"view-toggle",children:[s.jsx("button",{onClick:()=>a("all"),children:"All Transactions"}),s.jsx("button",{onClick:()=>a("trade"),children:"Trades Only"})]})]});y.propTypes={setViewType:e.func.isRequired};const g=({transaction:a,teams:n,formatDate:r})=>s.jsxs("div",{className:"transaction-info",children:[s.jsx("h3",{className:"details-header",children:a.type}),s.jsx("p",{className:"transaction-user",children:a.roster_ids.map((i,o)=>s.jsxs(O.Fragment,{children:[n[i]?`@ ${n[i]}`:`Roster ID: ${i}`,o<a.roster_ids.length-1&&s.jsx("br",{})]},o))}),s.jsx("p",{className:"transaction-date",children:r(a.status_updated)})]});g.propTypes={transaction:e.shape({type:e.string.isRequired,roster_ids:e.arrayOf(e.number).isRequired,status_updated:e.number.isRequired}).isRequired,teams:e.objectOf(e.string).isRequired,formatDate:e.func.isRequired};const b=({transaction:a,teams:n,players:r})=>s.jsx("div",{className:"trade-details",children:a.roster_ids.map((i,o)=>s.jsxs("div",{className:"team-assets",children:[s.jsxs("p",{className:"team-name",children:[n[i]," Acquires:"]}),s.jsxs("div",{className:"traded-players-container",children:[Object.entries(a.adds||{}).filter(([,t])=>t===i).map(([t])=>{var c,u,l,p;return s.jsxs("div",{className:"player",children:[s.jsx("img",{src:`https://sleepercdn.com/content/nfl/players/${t}.jpg`,alt:(c=r[t])==null?void 0:c.full_name,className:"player-image"}),s.jsxs("p",{children:[((u=r[t])==null?void 0:u.full_name)||"unknown player"," -"," ",((l=r[t])==null?void 0:l.position)||"unknown position"," ",((p=r[t])==null?void 0:p.team)||"FA"]})]},t)}),(a.draft_picks||[]).filter(t=>t.owner_id===i).map((t,c)=>s.jsxs("p",{className:"draft-pick",children:["Round ",t.round," - ",t.season]},c))]})]},o))});b.propTypes={transaction:e.shape({type:e.string.isRequired,roster_ids:e.arrayOf(e.number).isRequired,status_updated:e.number.isRequired,adds:e.objectOf(e.number),draft_picks:e.arrayOf(e.object)}).isRequired,teams:e.objectOf(e.string).isRequired,players:e.objectOf(e.shape({full_name:e.string,position:e.string,team:e.string})).isRequired,formatDate:e.func};const N=({transaction:a,players:n})=>s.jsxs("div",{className:"waiver-details",children:[s.jsx("div",{className:"added-players-container",children:a.adds&&Object.keys(a.adds).length>0?Object.keys(a.adds).map(r=>{var i,o,t,c;return s.jsx("div",{className:"added-player",children:s.jsxs("div",{className:"player-content",children:[s.jsx("p",{className:"transaction-icon",children:s.jsx("i",{className:"bx bx-plus-circle plus-icon"})}),s.jsx("img",{src:`https://sleepercdn.com/content/nfl/players/${r}.jpg`,alt:((i=n[r])==null?void 0:i.full_name)||"unknown player",className:"player-image"}),s.jsxs("p",{className:"player-name",children:[(o=n[r])==null?void 0:o.full_name," - ",(t=n[r])==null?void 0:t.position," ",(c=n[r])==null?void 0:c.team]})]})},r)}):s.jsx("div",{className:"added-player",children:s.jsxs("div",{className:"player-content",children:[" ",s.jsx("p",{className:"transaction-icon",children:s.jsx("i",{className:"bx bx-plus-circle plus-icon"})})]})})}),s.jsx("div",{className:"dropped-players-container",children:a.drops&&Object.keys(a.drops).length>0?Object.keys(a.drops).map(r=>{var i,o,t,c;return s.jsx("div",{className:"dropped-player",children:s.jsxs("div",{className:"player-content",children:[s.jsx("p",{className:"transaction-icon",children:s.jsx("i",{className:"bx bx-minus-circle minus-icon"})}),s.jsx("img",{src:`https://sleepercdn.com/content/nfl/players/${r}.jpg`,alt:((i=n[r])==null?void 0:i.full_name)||"unknown player",className:"player-image"}),s.jsxs("p",{children:[(o=n[r])==null?void 0:o.full_name," - ",(t=n[r])==null?void 0:t.position," ",(c=n[r])==null?void 0:c.team]})]})},r)}):s.jsx("div",{className:"dropped-player",children:s.jsx("div",{className:"player-content",children:s.jsx("p",{className:"transaction-icon",children:s.jsx("i",{className:"bx bx-minus-circle minus-icon"})})})})})]});N.propTypes={transaction:e.shape({adds:e.objectOf(e.number),drops:e.objectOf(e.number)}).isRequired,players:e.objectOf(e.shape({full_name:e.string,position:e.string,team:e.string})).isRequired};const R=({transaction:a,teams:n,players:r,formatDate:i})=>s.jsxs("div",{className:"transaction-row",children:[s.jsx(g,{transaction:a,teams:n,formatDate:i}),a.type==="trade"&&s.jsx(b,{transaction:a,teams:n,players:r}),(a.type==="waiver"||a.type==="free_agent")&&s.jsx(N,{transaction:a,players:r})]});R.propTypes={transaction:e.object.isRequired,teams:e.object.isRequired,players:e.object.isRequired,formatDate:e.func.isRequired};const T=({transactions:a,viewType:n,displayedCount:r,teams:i,players:o})=>{const t=c=>new Date(c).toLocaleString("en-us",{month:"long",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0});return s.jsx("div",{className:"transactions-list",children:a.filter(c=>n==="all"?!0:c.type==="trade").slice(0,r).map((c,u)=>s.jsx(R,{transaction:c,teams:i,players:o,formatDate:t},u))})};T.propTypes={transactions:e.arrayOf(e.shape({type:e.string.isRequired,roster_ids:e.arrayOf(e.number).isRequired,status_updated:e.number.isRequired,adds:e.objectOf(e.number)})).isRequired,viewType:e.string.isRequired,displayedCount:e.number.isRequired,teams:e.objectOf(e.string).isRequired,players:e.objectOf(e.shape({full_name:e.string})).isRequired,formatDate:e.func};const q=({displayedCount:a,transactions:n,loadMoreTransactions:r})=>s.jsx(s.Fragment,{children:a<n&&s.jsx("button",{onClick:r,className:"load-more",children:"Load More"})});q.propTypes={displayedCount:e.number.isRequired,transactions:e.number.isRequired,loadMoreTransactions:e.func.isRequired};const F=a=>{const[n,r]=m.useState([]),[i,o]=m.useState(!0),[t,c]=m.useState(null);return m.useEffect(()=>{(async()=>{try{const l=[];for(let d=1;d<=18;d++)l.push(L.get(`https://api.sleeper.app/v1/league/${a}/transactions/${d}`));const h=await Promise.all(l);let j=[];h.forEach(d=>{let x=d.data;const v=Object.values(x).filter(_=>_.status==="complete");j=[...j,...v]});const f=j.sort((d,x)=>x.status_updated-d.status_updated);r(f)}catch(l){c(l)}finally{o(!1)}})()},[a]),{transactions:n,loading:i,error:t}},H=()=>{const{teams:a,loading:n,error:r}=C(),{transactions:i,loading:o,error:t}=F(E),{players:c,loading:u,error:l}=S(),[p,h]=m.useState(10),[j,f]=m.useState("all");if(u||o||n)return s.jsx(k,{});if(l||t||r)return s.jsx("div",{children:"Error loading data"});const d=()=>{h(x=>x+10)};return s.jsxs("div",{className:"league-activity",children:[s.jsx(y,{setViewType:f}),s.jsx(T,{transactions:i,viewType:j,displayedCount:p,teams:a,players:c}),s.jsx(q,{displayedCount:p,transactions:i.length,loadMoreTransactions:d})]})};export{H as default};
